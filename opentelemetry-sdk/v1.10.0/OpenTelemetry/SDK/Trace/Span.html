<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: OpenTelemetry::SDK::Trace::Span
  
    &mdash; OpenTelemetry
  
</title>

  <link rel="stylesheet" href="../../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "OpenTelemetry::SDK::Trace::Span";
  relpath = '../../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../../_index.html">Index (S)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../OpenTelemetry.html" title="OpenTelemetry (module)">OpenTelemetry</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../SDK.html" title="OpenTelemetry::SDK (module)">SDK</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Trace.html" title="OpenTelemetry::SDK::Trace (module)">Trace</a></span></span>
     &raquo; 
    <span class="title">Span</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: OpenTelemetry::SDK::Trace::Span
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Trace::Span</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Trace::Span</li>
          
            <li class="next">OpenTelemetry::SDK::Trace::Span</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/opentelemetry/sdk/trace/span.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Implementation of Trace::Span that records trace events.</p>

<p>This implementation includes reader methods intended to allow access to internal state by <span class='object_link'><a href="SpanProcessor.html" title="OpenTelemetry::SDK::Trace::SpanProcessor (class)">SpanProcessor</a></span>s. Instrumentation should use the API provided by Trace::Span and should consider <span class='object_link'><a href="" title="OpenTelemetry::SDK::Trace::Span (class)">Span</a></span> to be write-only.</p>

<p>rubocop:disable Metrics/ClassLength</p>


  </div>
</div>
<div class="tags">
  

</div>



  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#end_timestamp-instance_method" title="#end_timestamp (instance method)">#<strong>end_timestamp</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The following readers are intended for the use of SpanProcessors and should not be considered part of the public interface for instrumentation.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#instrumentation_scope-instance_method" title="#instrumentation_scope (instance method)">#<strong>instrumentation_scope</strong>  &#x21d2; Object </a>
    

    
      (also: #instrumentation_library)
    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The following readers are intended for the use of SpanProcessors and should not be considered part of the public interface for instrumentation.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#kind-instance_method" title="#kind (instance method)">#<strong>kind</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The following readers are intended for the use of SpanProcessors and should not be considered part of the public interface for instrumentation.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#links-instance_method" title="#links (instance method)">#<strong>links</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The following readers are intended for the use of SpanProcessors and should not be considered part of the public interface for instrumentation.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#name-instance_method" title="#name (instance method)">#<strong>name</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The following readers are intended for the use of SpanProcessors and should not be considered part of the public interface for instrumentation.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#parent_span_id-instance_method" title="#parent_span_id (instance method)">#<strong>parent_span_id</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The following readers are intended for the use of SpanProcessors and should not be considered part of the public interface for instrumentation.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#resource-instance_method" title="#resource (instance method)">#<strong>resource</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The following readers are intended for the use of SpanProcessors and should not be considered part of the public interface for instrumentation.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#start_timestamp-instance_method" title="#start_timestamp (instance method)">#<strong>start_timestamp</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The following readers are intended for the use of SpanProcessors and should not be considered part of the public interface for instrumentation.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#status-instance_method" title="#status (instance method)">#<strong>status</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The following readers are intended for the use of SpanProcessors and should not be considered part of the public interface for instrumentation.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_attributes-instance_method" title="#add_attributes (instance method)">#<strong>add_attributes</strong>(attributes)  &#x21d2; self </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Add attributes.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_event-instance_method" title="#add_event (instance method)">#<strong>add_event</strong>(name, attributes: nil, timestamp: nil)  &#x21d2; self </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Add an Event to a <span class='object_link'><a href="" title="OpenTelemetry::SDK::Trace::Span (class)">Span</a></span>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_link-instance_method" title="#add_link (instance method)">#<strong>add_link</strong>(link)  &#x21d2; self </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Add a link to a <span class='object_link'><a href="" title="OpenTelemetry::SDK::Trace::Span (class)">Span</a></span>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#attributes-instance_method" title="#attributes (instance method)">#<strong>attributes</strong>  &#x21d2; Hash{String =&gt; String, Numeric, Boolean, Array&lt;String, Numeric, Boolean&gt;} </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return a frozen copy of the current attributes.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#events-instance_method" title="#events (instance method)">#<strong>events</strong>  &#x21d2; Array&lt;Event&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return a frozen copy of the current events.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#finish-instance_method" title="#finish (instance method)">#<strong>finish</strong>(end_timestamp: nil)  &#x21d2; self </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Finishes the Span.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(context, parent_context, parent_span, name, kind, parent_span_id, span_limits, span_processors, attributes, links, start_timestamp, resource, instrumentation_scope)  &#x21d2; Span </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of Span.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#record_exception-instance_method" title="#record_exception (instance method)">#<strong>record_exception</strong>(exception, attributes: nil)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Record an exception during the execution of this span.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#recording%3F-instance_method" title="#recording? (instance method)">#<strong>recording?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return the flag whether this span is recording events.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_attribute-instance_method" title="#set_attribute (instance method)">#<strong>set_attribute</strong>(key, value)  &#x21d2; self </a>
    

    
      (also: #[]=)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Set attribute.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_span_data-instance_method" title="#to_span_data (instance method)">#<strong>to_span_data</strong>  &#x21d2; SpanData </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
<p>Returns a SpanData containing a snapshot of the Span fields.</p>
</div></span>
  
</li>

      
    </ul>
  


  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(context, parent_context, parent_span, name, kind, parent_span_id, span_limits, span_processors, attributes, links, start_timestamp, resource, instrumentation_scope)  &#x21d2; <tt><span class='object_link'><a href="" title="OpenTelemetry::SDK::Trace::Span (class)">Span</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>

<p>Returns a new instance of Span.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opentelemetry/sdk/trace/span.rb', line 321</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_context'>context</span><span class='comma'>,</span> <span class='id identifier rubyid_parent_context'>parent_context</span><span class='comma'>,</span> <span class='id identifier rubyid_parent_span'>parent_span</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_kind'>kind</span><span class='comma'>,</span> <span class='id identifier rubyid_parent_span_id'>parent_span_id</span><span class='comma'>,</span> <span class='id identifier rubyid_span_limits'>span_limits</span><span class='comma'>,</span> <span class='id identifier rubyid_span_processors'>span_processors</span><span class='comma'>,</span> <span class='id identifier rubyid_attributes'>attributes</span><span class='comma'>,</span> <span class='id identifier rubyid_links'>links</span><span class='comma'>,</span> <span class='id identifier rubyid_start_timestamp'>start_timestamp</span><span class='comma'>,</span> <span class='id identifier rubyid_resource'>resource</span><span class='comma'>,</span> <span class='id identifier rubyid_instrumentation_scope'>instrumentation_scope</span><span class='rparen'>)</span> <span class='comment'># rubocop:disable Metrics/MethodLength, Metrics/PerceivedComplexity, Metrics/CyclomaticComplexity
</span>  <span class='kw'>super</span><span class='lparen'>(</span><span class='label'>span_context:</span> <span class='id identifier rubyid_context'>context</span><span class='rparen'>)</span>
  <span class='ivar'>@mutex</span> <span class='op'>=</span> <span class='const'>Mutex</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='ivar'>@name</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>
  <span class='ivar'>@kind</span> <span class='op'>=</span> <span class='id identifier rubyid_kind'>kind</span>
  <span class='ivar'>@parent_span_id</span> <span class='op'>=</span> <span class='id identifier rubyid_parent_span_id'>parent_span_id</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span> <span class='op'>||</span> <span class='const'><span class='object_link'><a href="../../../OpenTelemetry.html" title="OpenTelemetry (module)">OpenTelemetry</a></span></span><span class='op'>::</span><span class='const'>Trace</span><span class='op'>::</span><span class='const'>INVALID_SPAN_ID</span>
  <span class='ivar'>@parent_span_is_remote</span> <span class='op'>=</span> <span class='id identifier rubyid_parent_span'>parent_span</span><span class='op'>&amp;.</span><span class='id identifier rubyid_context'>context</span><span class='op'>&amp;.</span><span class='id identifier rubyid_remote?'>remote?</span> <span class='op'>||</span> <span class='kw'>false</span>
  <span class='ivar'>@span_limits</span> <span class='op'>=</span> <span class='id identifier rubyid_span_limits'>span_limits</span>
  <span class='ivar'>@span_processors</span> <span class='op'>=</span> <span class='id identifier rubyid_span_processors'>span_processors</span>
  <span class='ivar'>@resource</span> <span class='op'>=</span> <span class='id identifier rubyid_resource'>resource</span>
  <span class='ivar'>@instrumentation_scope</span> <span class='op'>=</span> <span class='id identifier rubyid_instrumentation_scope'>instrumentation_scope</span>
  <span class='ivar'>@ended</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='ivar'>@status</span> <span class='op'>=</span> <span class='const'>DEFAULT_STATUS</span>
  <span class='ivar'>@total_recorded_events</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='ivar'>@total_recorded_links</span> <span class='op'>=</span> <span class='id identifier rubyid_links'>links</span><span class='op'>&amp;.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>||</span> <span class='int'>0</span>
  <span class='ivar'>@total_recorded_attributes</span> <span class='op'>=</span> <span class='id identifier rubyid_attributes'>attributes</span><span class='op'>&amp;.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>||</span> <span class='int'>0</span>
  <span class='ivar'>@attributes</span> <span class='op'>=</span> <span class='id identifier rubyid_attributes'>attributes</span>
  <span class='id identifier rubyid_trim_span_attributes'>trim_span_attributes</span><span class='lparen'>(</span><span class='ivar'>@attributes</span><span class='rparen'>)</span>
  <span class='ivar'>@events</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@links</span> <span class='op'>=</span> <span class='id identifier rubyid_trim_links'>trim_links</span><span class='lparen'>(</span><span class='id identifier rubyid_links'>links</span><span class='comma'>,</span> <span class='id identifier rubyid_span_limits'>span_limits</span><span class='period'>.</span><span class='id identifier rubyid_link_count_limit'>link_count_limit</span><span class='comma'>,</span> <span class='id identifier rubyid_span_limits'>span_limits</span><span class='period'>.</span><span class='id identifier rubyid_link_attribute_count_limit'>link_attribute_count_limit</span><span class='rparen'>)</span>

  <span class='comment'># Times are hard. Whenever an explicit timestamp is provided
</span>  <span class='comment'># (for Events or for the Span start_timestamp or end_timestamp),
</span>  <span class='comment'># we use that as the recorded timestamp. An implicit Event timestamp
</span>  <span class='comment'># and end_timestamp is computed as a monotonic clock offset from
</span>  <span class='comment'># the realtime start_timestamp. The realtime start_timestamp is
</span>  <span class='comment'># computed as a monotonic clock offset from the realtime
</span>  <span class='comment'># start_timestamp of its parent span, if available, or it is
</span>  <span class='comment'># fetched from the realtime system clock.
</span>  <span class='comment'>#
</span>  <span class='comment'># We therefore have 3 start timestamps. The first two are used
</span>  <span class='comment'># internally (and by child spans) to compute other timestamps.
</span>  <span class='comment'># The last is the start timestamp actually recorded in the
</span>  <span class='comment'># SpanData.
</span>  <span class='ivar'>@monotonic_start_timestamp</span> <span class='op'>=</span> <span class='id identifier rubyid_monotonic_now'>monotonic_now</span>
  <span class='ivar'>@realtime_start_timestamp</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_parent_span'>parent_span</span><span class='period'>.</span><span class='id identifier rubyid_recording?'>recording?</span>
                                <span class='id identifier rubyid_relative_realtime'>relative_realtime</span><span class='lparen'>(</span><span class='id identifier rubyid_parent_span'>parent_span</span><span class='period'>.</span><span class='id identifier rubyid_realtime_start_timestamp'>realtime_start_timestamp</span><span class='comma'>,</span> <span class='id identifier rubyid_parent_span'>parent_span</span><span class='period'>.</span><span class='id identifier rubyid_monotonic_start_timestamp'>monotonic_start_timestamp</span><span class='comma'>,</span> <span class='ivar'>@monotonic_start_timestamp</span><span class='rparen'>)</span>
                              <span class='kw'>else</span>
                                <span class='id identifier rubyid_realtime_now'>realtime_now</span>
                              <span class='kw'>end</span>
  <span class='ivar'>@start_timestamp</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_start_timestamp'>start_timestamp</span>
                       <span class='id identifier rubyid_time_in_nanoseconds'>time_in_nanoseconds</span><span class='lparen'>(</span><span class='id identifier rubyid_start_timestamp'>start_timestamp</span><span class='rparen'>)</span>
                     <span class='kw'>else</span>
                       <span class='ivar'>@realtime_start_timestamp</span>
                     <span class='kw'>end</span>
  <span class='ivar'>@end_timestamp</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@span_processors</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_processor'>processor</span><span class='op'>|</span> <span class='id identifier rubyid_processor'>processor</span><span class='period'>.</span><span class='id identifier rubyid_on_start'>on_start</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_parent_context'>parent_context</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="end_timestamp-instance_method">
  
    #<strong>end_timestamp</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The following readers are intended for the use of SpanProcessors and should not be considered part of the public interface for instrumentation.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


26
27
28</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opentelemetry/sdk/trace/span.rb', line 26</span>

<span class='kw'>def</span> <span class='id identifier rubyid_end_timestamp'>end_timestamp</span>
  <span class='ivar'>@end_timestamp</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="instrumentation_scope-instance_method">
  
    #<strong>instrumentation_scope</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='instrumentation_library-instance_method'>instrumentation_library</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The following readers are intended for the use of SpanProcessors and should not be considered part of the public interface for instrumentation.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


26
27
28</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opentelemetry/sdk/trace/span.rb', line 26</span>

<span class='kw'>def</span> <span class='id identifier rubyid_instrumentation_scope'>instrumentation_scope</span>
  <span class='ivar'>@instrumentation_scope</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="kind-instance_method">
  
    #<strong>kind</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The following readers are intended for the use of SpanProcessors and should not be considered part of the public interface for instrumentation.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


26
27
28</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opentelemetry/sdk/trace/span.rb', line 26</span>

<span class='kw'>def</span> <span class='id identifier rubyid_kind'>kind</span>
  <span class='ivar'>@kind</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="links-instance_method">
  
    #<strong>links</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The following readers are intended for the use of SpanProcessors and should not be considered part of the public interface for instrumentation.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


26
27
28</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opentelemetry/sdk/trace/span.rb', line 26</span>

<span class='kw'>def</span> <span class='id identifier rubyid_links'>links</span>
  <span class='ivar'>@links</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="name=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="name-instance_method">
  
    #<strong>name</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The following readers are intended for the use of SpanProcessors and should not be considered part of the public interface for instrumentation.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


26
27
28</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opentelemetry/sdk/trace/span.rb', line 26</span>

<span class='kw'>def</span> <span class='id identifier rubyid_name'>name</span>
  <span class='ivar'>@name</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="parent_span_id-instance_method">
  
    #<strong>parent_span_id</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The following readers are intended for the use of SpanProcessors and should not be considered part of the public interface for instrumentation.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


26
27
28</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opentelemetry/sdk/trace/span.rb', line 26</span>

<span class='kw'>def</span> <span class='id identifier rubyid_parent_span_id'>parent_span_id</span>
  <span class='ivar'>@parent_span_id</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="resource-instance_method">
  
    #<strong>resource</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The following readers are intended for the use of SpanProcessors and should not be considered part of the public interface for instrumentation.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


26
27
28</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opentelemetry/sdk/trace/span.rb', line 26</span>

<span class='kw'>def</span> <span class='id identifier rubyid_resource'>resource</span>
  <span class='ivar'>@resource</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="start_timestamp-instance_method">
  
    #<strong>start_timestamp</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The following readers are intended for the use of SpanProcessors and should not be considered part of the public interface for instrumentation.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


26
27
28</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opentelemetry/sdk/trace/span.rb', line 26</span>

<span class='kw'>def</span> <span class='id identifier rubyid_start_timestamp'>start_timestamp</span>
  <span class='ivar'>@start_timestamp</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="status=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="status-instance_method">
  
    #<strong>status</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The following readers are intended for the use of SpanProcessors and should not be considered part of the public interface for instrumentation.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


26
27
28</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opentelemetry/sdk/trace/span.rb', line 26</span>

<span class='kw'>def</span> <span class='id identifier rubyid_status'>status</span>
  <span class='ivar'>@status</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="add_attributes-instance_method">
  
    #<strong>add_attributes</strong>(attributes)  &#x21d2; <tt>self</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Add attributes</p>

<p>Note that the OpenTelemetry project <a href="https://github.com/open-telemetry/opentelemetry-specification/blob/master/specification/data-semantic-conventions.md" target="_parent" title="documents">documents</a> certain “standard attributes” that have prescribed semantic meanings.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>attributes</span>
      
      
        <span class='type'>(<tt>Hash{String =&gt; String, Numeric, Boolean, Array&lt;String, Numeric, Boolean&gt;}</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Values must be non-nil and (array of) string, boolean or numeric type. Array values must not contain nil elements and all elements must be of the same basic type (string, numeric, boolean).</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>self</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>returns itself</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


107
108
109
110
111
112
113
114
115
116
117
118
119</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opentelemetry/sdk/trace/span.rb', line 107</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_attributes'>add_attributes</span><span class='lparen'>(</span><span class='id identifier rubyid_attributes'>attributes</span><span class='rparen'>)</span>
  <span class='ivar'>@mutex</span><span class='period'>.</span><span class='id identifier rubyid_synchronize'>synchronize</span> <span class='kw'>do</span>
    <span class='kw'>if</span> <span class='ivar'>@ended</span>
      <span class='const'><span class='object_link'><a href="../../../OpenTelemetry.html" title="OpenTelemetry (module)">OpenTelemetry</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_warn'>warn</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Calling add_attributes on an ended Span.</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='ivar'>@attributes</span> <span class='op'>||=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
      <span class='ivar'>@attributes</span><span class='period'>.</span><span class='id identifier rubyid_merge!'>merge!</span><span class='lparen'>(</span><span class='id identifier rubyid_attributes'>attributes</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_trim_span_attributes'>trim_span_attributes</span><span class='lparen'>(</span><span class='ivar'>@attributes</span><span class='rparen'>)</span>
      <span class='ivar'>@total_recorded_attributes</span> <span class='op'>+=</span> <span class='id identifier rubyid_attributes'>attributes</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="add_event-instance_method">
  
    #<strong>add_event</strong>(name, attributes: nil, timestamp: nil)  &#x21d2; <tt>self</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Add an Event to a <span class='object_link'><a href="" title="OpenTelemetry::SDK::Trace::Span (class)">OpenTelemetry::SDK::Trace::Span</a></span>.</p>

<p>Example:</p>

<p>span.add_event(‘event’, attributes: =&gt; true)</p>

<p>Note that the OpenTelemetry project <a href="https://github.com/open-telemetry/opentelemetry-specification/blob/master/specification/data-semantic-conventions.md" target="_parent" title="documents">documents</a> certain “standard event names and keys” which have prescribed semantic meanings.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Name of the event.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>attributes</span>
      
      
        <span class='type'>(<tt>optional Hash{String =&gt; String, Numeric, Boolean, Array&lt;String, Numeric, Boolean&gt;}</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>One or more key:value pairs, where the keys must be strings and the values may be (array of) string, boolean or numeric type.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>timestamp</span>
      
      
        <span class='type'>(<tt>optional Time</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Optional timestamp for the event.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>self</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>returns itself</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


170
171
172
173
174
175
176
177
178
179
180
181
182
183</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opentelemetry/sdk/trace/span.rb', line 170</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_event'>add_event</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='label'>attributes:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>timestamp:</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_event'>event</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Event.html" title="OpenTelemetry::SDK::Trace::Event (class)">Event</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_truncate_attribute_values'>truncate_attribute_values</span><span class='lparen'>(</span><span class='id identifier rubyid_attributes'>attributes</span><span class='comma'>,</span> <span class='ivar'>@span_limits</span><span class='period'>.</span><span class='id identifier rubyid_event_attribute_length_limit'>event_attribute_length_limit</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_relative_timestamp'>relative_timestamp</span><span class='lparen'>(</span><span class='id identifier rubyid_timestamp'>timestamp</span><span class='rparen'>)</span><span class='rparen'>)</span>

  <span class='ivar'>@mutex</span><span class='period'>.</span><span class='id identifier rubyid_synchronize'>synchronize</span> <span class='kw'>do</span>
    <span class='kw'>if</span> <span class='ivar'>@ended</span>
      <span class='const'><span class='object_link'><a href="../../../OpenTelemetry.html" title="OpenTelemetry (module)">OpenTelemetry</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_warn'>warn</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Calling add_event on an ended Span.</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='ivar'>@events</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
      <span class='ivar'>@events</span> <span class='op'>=</span> <span class='id identifier rubyid_append_event'>append_event</span><span class='lparen'>(</span><span class='ivar'>@events</span><span class='comma'>,</span> <span class='id identifier rubyid_event'>event</span><span class='rparen'>)</span>
      <span class='ivar'>@total_recorded_events</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="add_link-instance_method">
  
    #<strong>add_link</strong>(link)  &#x21d2; <tt>self</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Add a link to a <span class='object_link'><a href="" title="OpenTelemetry::SDK::Trace::Span (class)">OpenTelemetry::SDK::Trace::Span</a></span>.</p>

<p>Adding links at span creation using the <code>links</code> option is preferred to calling add_link later, because head sampling decisions can only consider information present during span creation.</p>

<p>Example:</p>

<p>span.add_link(OpenTelemetry::Trace::Link.new(span_to_link_from.context))</p>

<p>Note that the OpenTelemetry project <a href="https://github.com/open-telemetry/opentelemetry-specification/blob/master/specification/data-semantic-conventions.md" target="_parent" title="documents">documents</a> certain “standard attributes” that have prescribed semantic meanings.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>the</span>
      
      
        <span class='type'>(<tt>OpenTelemetry::Trace::Link</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>link object to add on the <span class='object_link'><a href="" title="OpenTelemetry::SDK::Trace::Span (class)">OpenTelemetry::SDK::Trace::Span</a></span>.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>self</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>returns itself</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


139
140
141
142
143
144
145
146
147
148
149
150</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opentelemetry/sdk/trace/span.rb', line 139</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_link'>add_link</span><span class='lparen'>(</span><span class='id identifier rubyid_link'>link</span><span class='rparen'>)</span>
  <span class='ivar'>@mutex</span><span class='period'>.</span><span class='id identifier rubyid_synchronize'>synchronize</span> <span class='kw'>do</span>
    <span class='kw'>if</span> <span class='ivar'>@ended</span>
      <span class='const'><span class='object_link'><a href="../../../OpenTelemetry.html" title="OpenTelemetry (module)">OpenTelemetry</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_warn'>warn</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Calling add_link on an ended Span.</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='ivar'>@links</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
      <span class='ivar'>@links</span> <span class='op'>=</span> <span class='id identifier rubyid_trim_links'>trim_links</span><span class='lparen'>(</span><span class='ivar'>@links</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_link'>link</span><span class='comma'>,</span> <span class='ivar'>@span_limits</span><span class='period'>.</span><span class='id identifier rubyid_link_count_limit'>link_count_limit</span><span class='comma'>,</span> <span class='ivar'>@span_limits</span><span class='period'>.</span><span class='id identifier rubyid_link_attribute_count_limit'>link_attribute_count_limit</span><span class='rparen'>)</span>
      <span class='ivar'>@total_recorded_links</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="attributes-instance_method">
  
    #<strong>attributes</strong>  &#x21d2; <tt>Hash{String =&gt; String, Numeric, Boolean, Array&lt;String, Numeric, Boolean&gt;}</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return a frozen copy of the current attributes. This is intended for use of SpanProcessors and should not be considered part of the public interface for instrumentation.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash{String =&gt; String, Numeric, Boolean, Array&lt;String, Numeric, Boolean&gt;}</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>may be nil.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


39
40
41
42
43</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opentelemetry/sdk/trace/span.rb', line 39</span>

<span class='kw'>def</span> <span class='id identifier rubyid_attributes'>attributes</span>
  <span class='comment'># Don&#39;t bother synchronizing. Access by SpanProcessors is expected to
</span>  <span class='comment'># be serialized.
</span>  <span class='ivar'>@attributes</span><span class='op'>&amp;.</span><span class='id identifier rubyid_clone'>clone</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="events-instance_method">
  
    #<strong>events</strong>  &#x21d2; <tt>Array&lt;<span class='object_link'><a href="Event.html" title="OpenTelemetry::SDK::Trace::Event (class)">Event</a></span>&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return a frozen copy of the current events. This is intended for use of SpanProcessors and should not be considered part of the public interface for instrumentation.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="Event.html" title="OpenTelemetry::SDK::Trace::Event (class)">Event</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>may be nil.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


50
51
52
53
54</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opentelemetry/sdk/trace/span.rb', line 50</span>

<span class='kw'>def</span> <span class='id identifier rubyid_events'>events</span>
  <span class='comment'># Don&#39;t bother synchronizing. Access by SpanProcessors is expected to
</span>  <span class='comment'># be serialized.
</span>  <span class='ivar'>@events</span><span class='op'>&amp;.</span><span class='id identifier rubyid_clone'>clone</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="finish-instance_method">
  
    #<strong>finish</strong>(end_timestamp: nil)  &#x21d2; <tt>self</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Finishes the Span</p>

<p>Implementations MUST ignore all subsequent calls to <span class='object_link'><a href="#finish-instance_method" title="OpenTelemetry::SDK::Trace::Span#finish (method)">#finish</a></span> (there might be exceptions when Tracer is streaming event and has no mutable state associated with the Span).</p>

<p>Call to <span class='object_link'><a href="#finish-instance_method" title="OpenTelemetry::SDK::Trace::Span#finish (method)">#finish</a></span> MUST not have any effects on child spans. Those may still be running and can be ended later.</p>

<p>This API MUST be non-blocking*.</p>

<p>(*) not actually non-blocking. In particular, it synchronizes on an internal mutex, which will typically be uncontended, and <span class='object_link'><a href="Export/BatchSpanProcessor.html" title="OpenTelemetry::SDK::Trace::Export::BatchSpanProcessor (class)">Export::BatchSpanProcessor</a></span> will also synchronize on a mutex, if that processor is used.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>end_timestamp</span>
      
      
        <span class='type'>(<tt>Time</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>optional end timestamp for the span.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>self</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>returns itself</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opentelemetry/sdk/trace/span.rb', line 267</span>

<span class='kw'>def</span> <span class='id identifier rubyid_finish'>finish</span><span class='lparen'>(</span><span class='label'>end_timestamp:</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='ivar'>@mutex</span><span class='period'>.</span><span class='id identifier rubyid_synchronize'>synchronize</span> <span class='kw'>do</span>
    <span class='kw'>if</span> <span class='ivar'>@ended</span>
      <span class='const'><span class='object_link'><a href="../../../OpenTelemetry.html" title="OpenTelemetry (module)">OpenTelemetry</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_warn'>warn</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Calling finish on an ended Span.</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='kw'>return</span> <span class='kw'>self</span>
    <span class='kw'>end</span>
    <span class='ivar'>@end_timestamp</span> <span class='op'>=</span> <span class='id identifier rubyid_relative_timestamp'>relative_timestamp</span><span class='lparen'>(</span><span class='id identifier rubyid_end_timestamp'>end_timestamp</span><span class='rparen'>)</span>
    <span class='ivar'>@span_processors</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_processor'>processor</span><span class='op'>|</span>
      <span class='id identifier rubyid_processor'>processor</span><span class='period'>.</span><span class='id identifier rubyid_on_finishing'>on_finishing</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_processor'>processor</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:on_finishing</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='ivar'>@attributes</span> <span class='op'>=</span> <span class='id identifier rubyid_validated_attributes'>validated_attributes</span><span class='lparen'>(</span><span class='ivar'>@attributes</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>
    <span class='ivar'>@events</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>
    <span class='ivar'>@links</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>
    <span class='ivar'>@ended</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
  <span class='ivar'>@span_processors</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_processor'>processor</span><span class='op'>|</span> <span class='id identifier rubyid_processor'>processor</span><span class='period'>.</span><span class='id identifier rubyid_on_finish'>on_finish</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="record_exception-instance_method">
  
    #<strong>record_exception</strong>(exception, attributes: nil)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Record an exception during the execution of this span. Multiple exceptions can be recorded on a span.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>exception</span>
      
      
        <span class='type'>(<tt>Exception</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The exception to be recorded</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>attributes</span>
      
      
        <span class='type'>(<tt>optional Hash{String =&gt; String, Numeric, Boolean, Array&lt;String, Numeric, Boolean&gt;}</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>One or more key:value pairs, where the keys must be strings and the values may be (array of) string, boolean or numeric type.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


195
196
197
198
199
200
201
202
203</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opentelemetry/sdk/trace/span.rb', line 195</span>

<span class='kw'>def</span> <span class='id identifier rubyid_record_exception'>record_exception</span><span class='lparen'>(</span><span class='id identifier rubyid_exception'>exception</span><span class='comma'>,</span> <span class='label'>attributes:</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_event_attributes'>event_attributes</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>exception.type</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_exception'>exception</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>exception.message</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_exception'>exception</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>exception.stacktrace</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_exception'>exception</span><span class='period'>.</span><span class='id identifier rubyid_full_message'>full_message</span><span class='lparen'>(</span><span class='label'>highlight:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>order:</span> <span class='symbol'>:top</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_encode'>encode</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>UTF-8</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>invalid:</span> <span class='symbol'>:replace</span><span class='comma'>,</span> <span class='label'>undef:</span> <span class='symbol'>:replace</span><span class='comma'>,</span> <span class='label'>replace:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>�</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='rbrace'>}</span>
  <span class='id identifier rubyid_event_attributes'>event_attributes</span><span class='period'>.</span><span class='id identifier rubyid_merge!'>merge!</span><span class='lparen'>(</span><span class='id identifier rubyid_attributes'>attributes</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_attributes'>attributes</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='id identifier rubyid_add_event'>add_event</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>exception</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>attributes:</span> <span class='id identifier rubyid_event_attributes'>event_attributes</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="recording?-instance_method">
  
    #<strong>recording?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return the flag whether this span is recording events</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>true if this Span is active and recording information like events with the #add_event operation and attributes using</p>

<h1 id="label-set_attribute.">set_attribute.</h1>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


61
62
63</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opentelemetry/sdk/trace/span.rb', line 61</span>

<span class='kw'>def</span> <span class='id identifier rubyid_recording?'>recording?</span>
  <span class='op'>!</span><span class='ivar'>@ended</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_attribute-instance_method">
  
    #<strong>set_attribute</strong>(key, value)  &#x21d2; <tt>self</tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='[]=-instance_method'>[]=</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Set attribute</p>

<p>Note that the OpenTelemetry project <a href="https://github.com/open-telemetry/opentelemetry-specification/blob/master/specification/data-semantic-conventions.md" target="_parent" title="documents">documents</a> certain “standard attributes” that have prescribed semantic meanings.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>key</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>value</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>Boolean</tt>, <tt>Numeric</tt>, <tt>Array&lt;String, Numeric, Boolean&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Values must be non-nil and (array of) string, boolean or numeric type. Array values must not contain nil elements and all elements must be of the same basic type (string, numeric, boolean).</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>self</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>returns itself</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


79
80
81
82
83
84
85
86
87
88
89
90
91</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opentelemetry/sdk/trace/span.rb', line 79</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_attribute'>set_attribute</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='ivar'>@mutex</span><span class='period'>.</span><span class='id identifier rubyid_synchronize'>synchronize</span> <span class='kw'>do</span>
    <span class='kw'>if</span> <span class='ivar'>@ended</span>
      <span class='const'><span class='object_link'><a href="../../../OpenTelemetry.html" title="OpenTelemetry (module)">OpenTelemetry</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_warn'>warn</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Calling set_attribute on an ended Span.</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='ivar'>@attributes</span> <span class='op'>||=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
      <span class='ivar'>@attributes</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
      <span class='id identifier rubyid_trim_span_attributes'>trim_span_attributes</span><span class='lparen'>(</span><span class='ivar'>@attributes</span><span class='rparen'>)</span>
      <span class='ivar'>@total_recorded_attributes</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="to_span_data-instance_method">
  
    #<strong>to_span_data</strong>  &#x21d2; <tt><span class='object_link'><a href="SpanData.html" title="OpenTelemetry::SDK::Trace::SpanData (class)">SpanData</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>

<p>Returns a SpanData containing a snapshot of the Span fields. It is assumed that the Span has been finished, and that no further modifications will be made to the Span.</p>

<p>This method should be called <em>only</em> from a SpanProcessor prior to calling the SpanExporter.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="SpanData.html" title="OpenTelemetry::SDK::Trace::SpanData (class)">SpanData</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opentelemetry/sdk/trace/span.rb', line 296</span>

<span class='kw'>def</span> <span class='id identifier rubyid_to_span_data'>to_span_data</span>
  <span class='const'><span class='object_link'><a href="SpanData.html" title="OpenTelemetry::SDK::Trace::SpanData (class)">SpanData</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
    <span class='ivar'>@name</span><span class='comma'>,</span>
    <span class='ivar'>@kind</span><span class='comma'>,</span>
    <span class='ivar'>@status</span><span class='comma'>,</span>
    <span class='ivar'>@parent_span_id</span><span class='comma'>,</span>
    <span class='ivar'>@total_recorded_attributes</span><span class='comma'>,</span>
    <span class='ivar'>@total_recorded_events</span><span class='comma'>,</span>
    <span class='ivar'>@total_recorded_links</span><span class='comma'>,</span>
    <span class='ivar'>@start_timestamp</span><span class='comma'>,</span>
    <span class='ivar'>@end_timestamp</span><span class='comma'>,</span>
    <span class='ivar'>@attributes</span><span class='comma'>,</span>
    <span class='ivar'>@links</span><span class='comma'>,</span>
    <span class='ivar'>@events</span><span class='comma'>,</span>
    <span class='ivar'>@resource</span><span class='comma'>,</span>
    <span class='ivar'>@instrumentation_scope</span><span class='comma'>,</span>
    <span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_span_id'>span_id</span><span class='comma'>,</span>
    <span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_trace_id'>trace_id</span><span class='comma'>,</span>
    <span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_trace_flags'>trace_flags</span><span class='comma'>,</span>
    <span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_tracestate'>tracestate</span><span class='comma'>,</span>
    <span class='ivar'>@parent_span_is_remote</span>
  <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Tue Oct 14 16:56:09 2025 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.1.6).
</div>

    </div>
  </body>
</html>